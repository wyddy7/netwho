# NetWho Bot

**AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥–∞.** –£–º–Ω–∞—è –∑–∞–ø–∏—Å–Ω–∞—è –∫–Ω–∏–∂–∫–∞, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (Recall system) –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç—Ä–æ.

## üõ† –°—Ç–µ–∫
*   **Python 3.11+** (–≤ Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 3.11-slim)
*   **Aiogram 3.x** (Telegram Bot API)
*   **Supabase** (PostgreSQL + Auth)
*   **OpenRouter / OpenAI** (LLM inference)
*   **Groq** (Voice transcription)
*   **APScheduler** (Background tasks)
*   **uv** (Package manager)

## üöÄ –ó–∞–ø—É—Å–∫

### Docker (–ü—Ä–æ–¥–∞–∫—à–µ–Ω)

1.  **–°–æ–∑–¥–∞–π—Ç–µ `.env`** (–Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`):
    ```bash
    cp .env.example .env
    ```

2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**:
    ```bash
    docker compose up -d --build
    ```

3.  **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**:
    ```bash
    docker compose logs -f bot
    ```

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `uv`** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
    ```bash
    # Windows (PowerShell)
    powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
    
    # Linux/Mac
    curl -LsSf https://astral.sh/uv/install.sh | sh
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
    ```bash
    uv sync
    ```

3.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
    ```bash
    uv run python -m app.main
    ```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :---: | :--- |
| `BOT_TOKEN` | ‚úÖ | –¢–æ–∫–µ–Ω –æ—Ç [@BotFather](https://t.me/BotFather) |
| `SUPABASE_URL` | ‚úÖ | URL –ø—Ä–æ–µ–∫—Ç–∞ Supabase |
| `SUPABASE_KEY` | ‚ö†Ô∏è | –£—Å—Ç–∞—Ä–µ–≤—à–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π `SUPABASE_SERVICE_ROLE_KEY` |
| `SUPABASE_SERVICE_ROLE_KEY` | ‚úÖ | **Service Role** –∫–ª—é—á (–æ–±—Ö–æ–¥–∏—Ç RLS, –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î) |
| `OPENROUTER_API_KEY` | ‚úÖ | –ö–ª—é—á OpenRouter (–∏–ª–∏ OpenAI) |
| `ADMIN_ID` | ‚úÖ | Telegram ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–¥–ª—è –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥) |
| `LOG_LEVEL` | ‚ùå | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `DEBUG`, `INFO`, `WARNING`, `ERROR` (–¥–µ—Ñ–æ–ª—Ç: `INFO`) |
| `GROQ_API_KEY` | ‚ùå | –î–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ì–° (–µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω ‚Äî –≤–æ–π—Å—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è) |
| `LLM_MODEL` | ‚ùå | –î–µ—Ñ–æ–ª—Ç: `openai/gpt-4o-mini` |

## üì¶ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ú–∏–≥—Ä–∞—Ü–∏–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Supabase** (PostgreSQL).
*   SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `/migrations`.
*   **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Supabase Dashboard (SQL Editor) –∏–ª–∏ psql. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∫–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–µ—Ç.

## üîß –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã** (–¥–æ—Å—Ç—É–ø–Ω—ã `ADMIN_ID`):
*   `/admin` ‚Äî –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥.
*   `/check_user <user_id>` ‚Äî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏, —Ç—Ä–∏–∞–ª–∞ –∏ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*   `/give_pro <user_id> <days>` ‚Äî –í—ã–¥–∞—Ç—å Premium –Ω–∞ N –¥–Ω–µ–π.
*   `/revoke_pro <user_id>` ‚Äî –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.
*   `/debug_user <user_id>` ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã** (–≤ –ø–∞–ø–∫–µ `/scripts`):
*   `uv run python scripts/check_db.py` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î.
*   `uv run python scripts/test_db.py` ‚Äî –ü—Ä—è–º–æ–π —Ç–µ—Å—Ç Supabase (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, RLS).
*   `uv run python scripts/revoke_trial.py` ‚Äî –ú–∞—Å—Å–æ–≤—ã–π –æ—Ç–∑—ã–≤ —Ç—Ä–∏–∞–ª–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ).
*   `uv run python scripts/test_ai.py` ‚Äî –¢–µ—Å—Ç LLM –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞.

## üí° –õ–∏–º–∏—Ç—ã (Freemium)

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `app/config.py` (–∏–ª–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ env, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö —Ç—É–¥–∞).
*   **Trial**: 3 –¥–Ω—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.
*   **Free**: 10 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, 30 —Å–µ–∫ –≤–æ–π—Å—ã.
*   **Pro**: –ë–µ–∑–ª–∏–º–∏—Ç.
